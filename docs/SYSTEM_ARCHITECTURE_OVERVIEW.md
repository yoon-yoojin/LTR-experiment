# LTR System Architecture - ì „ì²´ ì‹œìŠ¤í…œ ì„¤ê³„

> Learning to Rank ì‹œìŠ¤í…œì˜ End-to-End ì•„í‚¤í…ì²˜ ê°€ì´ë“œ

## ëª©ì°¨
- [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
- [ë ˆí¬ì§€í† ë¦¬ êµ¬ì¡°](#ë ˆí¬ì§€í† ë¦¬-êµ¬ì¡°)
- [ë°ì´í„° íë¦„](#ë°ì´í„°-íë¦„)
- [ê°œë°œ í”„ë¡œì„¸ìŠ¤](#ê°œë°œ-í”„ë¡œì„¸ìŠ¤)
- [ë°°í¬ ì „ëµ](#ë°°í¬-ì „ëµ)
- [ëª¨ë‹ˆí„°ë§ ë° í”¼ë“œë°±](#ëª¨ë‹ˆí„°ë§-ë°-í”¼ë“œë°±)
- [í™•ì¥ ë¡œë“œë§µ](#í™•ì¥-ë¡œë“œë§µ)

---

## ì‹œìŠ¤í…œ ê°œìš”

### ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   LTR ML System Architecture                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Research & Dev        â”‚         â”‚   Production Serving    â”‚
â”‚                         â”‚         â”‚                         â”‚
â”‚  learning_to_rank/      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   ltr-serving/          â”‚
â”‚                         â”‚  ëª¨ë¸    â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  ì „ë‹¬   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Model Dev        â”‚   â”‚         â”‚  â”‚ FastAPI Server   â”‚   â”‚
â”‚  â”‚ - RankNet        â”‚   â”‚         â”‚  â”‚ - ONNX Runtime   â”‚   â”‚
â”‚  â”‚ - LambdaRank     â”‚   â”‚         â”‚  â”‚ - Redis Cache    â”‚   â”‚
â”‚  â”‚ - ListNet        â”‚   â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚         â”‚                         â”‚
â”‚                         â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚         â”‚  â”‚ Kubernetes       â”‚   â”‚
â”‚  â”‚ Experiment       â”‚   â”‚         â”‚  â”‚ - Auto-scaling   â”‚   â”‚
â”‚  â”‚ - Tracking       â”‚   â”‚         â”‚  â”‚ - Load Balancer  â”‚   â”‚
â”‚  â”‚ - Comparison     â”‚   â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚         â”‚                         â”‚
â”‚                         â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚         â”‚  â”‚ Monitoring       â”‚   â”‚
â”‚  â”‚ Offline Eval     â”‚   â”‚         â”‚  â”‚ - Prometheus     â”‚   â”‚
â”‚  â”‚ - NDCG, MAP      â”‚   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚ - Grafana        â”‚   â”‚
â”‚  â”‚ - MRR            â”‚   â”‚  í”¼ë“œë°±  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚         â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                    â”‚
         â”‚                                    â”‚
         â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Model Registry         â”‚         â”‚  Online Metrics         â”‚
â”‚  (Optional - Phase 5)   â”‚         â”‚                         â”‚
â”‚                         â”‚         â”‚  - Click-through Rate   â”‚
â”‚  - MLflow               â”‚         â”‚  - User Engagement      â”‚
â”‚  - Version Control      â”‚         â”‚  - Business KPIs        â”‚
â”‚  - Metadata             â”‚         â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë ˆí¬ì§€í† ë¦¬ êµ¬ì¡°

### 1. learning_to_rank (Research & Development)

**ì—­í• **: ëª¨ë¸ ì—°êµ¬ ë° ê°œë°œ

```yaml
ëª©ì : Model Development & Experimentation

í•µì‹¬ ì±…ì„:
  - ëª¨ë¸ ì•„í‚¤í…ì²˜ ê°œë°œ (Pairwise, Listwise)
  - í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹
  - ì‹¤í—˜ ì¶”ì  ë° ë¹„êµ
  - ì˜¤í”„ë¼ì¸ í‰ê°€ (NDCG, MAP, MRR)
  - í”„ë¡œë•ì…˜ìš© ëª¨ë¸ ì•„í‹°íŒ©íŠ¸ ìƒì„±

ê¸°ìˆ  ìŠ¤íƒ:
  - PyTorch (ëª¨ë¸ ê°œë°œ)
  - TensorBoard (ì‹¤í—˜ ì¶”ì )
  - scikit-learn (ì „ì²˜ë¦¬)
  - YAML (ì„¤ì • ê´€ë¦¬)

ì‚°ì¶œë¬¼:
  - checkpoints/validated/model_v1.0.0.pt
  - production/model_v1.0.0.onnx
  - experiments/exp001/results.json

ì†Œìœ : Data Science / ML Research Team
ë°°í¬: ì—†ìŒ (ê°œë°œ í™˜ê²½)
ì—…ë°ì´íŠ¸ ì£¼ê¸°: ì£¼ 1-2íšŒ (ì‹¤í—˜ ì‹œ)
```

### 2. ltr-serving (Production Serving)

**ì—­í• **: ì‹¤ì‹œê°„ API ì„œë¹™

```yaml
ëª©ì : Real-time Model Serving

í•µì‹¬ ì±…ì„:
  - ì‹¤ì‹œê°„ REST API ì œê³µ
  - ONNX ê¸°ë°˜ ê³ ì† ì¶”ë¡ 
  - ê²°ê³¼ ìºì‹± (Redis)
  - ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒ
  - A/B í…ŒìŠ¤íŠ¸
  - Auto-scaling

ê¸°ìˆ  ìŠ¤íƒ:
  - FastAPI (API ì„œë²„)
  - ONNX Runtime (ì¶”ë¡ )
  - Redis (ìºì‹±)
  - Kubernetes (ë°°í¬)
  - Prometheus + Grafana (ëª¨ë‹ˆí„°ë§)

API ì—”ë“œí¬ì¸íŠ¸:
  - POST /api/v1/rank
  - POST /api/v1/batch_rank
  - GET /health
  - GET /metrics

ì†Œìœ : ML Platform / Engineering Team
ë°°í¬: Kubernetes Cluster
ì—…ë°ì´íŠ¸ ì£¼ê¸°: ì›” 1-2íšŒ (ëª¨ë¸ ì—…ë°ì´íŠ¸)
```

### 3. ml-platform (Optional - Future)

**ì—­í• **: MLOps ì¸í”„ë¼

```yaml
ëª©ì : ML Infrastructure & Orchestration

í•µì‹¬ ì±…ì„:
  - Feature Store ìš´ì˜
  - Model Registry ê´€ë¦¬
  - Experiment Platform ì œê³µ
  - Data Pipeline ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
  - í†µí•© ëª¨ë‹ˆí„°ë§

ê¸°ìˆ  ìŠ¤íƒ:
  - Feast (Feature Store)
  - MLflow (Model Registry)
  - Airflow (Data Pipeline)
  - Custom Framework (A/B Testing)

ì†Œìœ : ML Platform Team
ë°°í¬: Cloud Infrastructure
ì—…ë°ì´íŠ¸ ì£¼ê¸°: ì§€ì†ì 
```

---

## ë°ì´í„° íë¦„

### End-to-End Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ë°ì´í„° íë¦„ë„                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. ëª¨ë¸ ê°œë°œ (learning_to_rank)
   â†“
   [Raw Data] â†’ [Preprocessing] â†’ [Train/Val Split]
   â†“
   [Model Training] â†’ [Validation] â†’ [Best Model Selection]
   â†“
   checkpoints/validated/lambdarank_v1.0.0.pt

2. ëª¨ë¸ ë³€í™˜ ë° ê²€ì¦
   â†“
   [PyTorch â†’ ONNX] â†’ [Latency Benchmark] â†’ [Accuracy Check]
   â†“
   production/model_v1.0.0.onnx

3. í”„ë¡œë•ì…˜ ë°°í¬ (ltr-serving)
   â†“
   [Docker Build] â†’ [K8s Deploy] â†’ [Canary Release]
   â†“
   ì‹¤ì‹œê°„ API ì„œë¹™

4. ì˜¨ë¼ì¸ ì„œë¹™
   â†“
   [Client Request] â†’ [Cache Check] â†’ [ONNX Inference] â†’ [Response]
   â†“
   [Metrics Collection] â†’ [Monitoring]

5. í”¼ë“œë°± ë£¨í”„
   â†“
   [Online Metrics] â†’ [Performance Analysis] â†’ [New Experiments]
   â†“
   learning_to_rank (ë‹¤ìŒ iteration)
```

### ëª¨ë¸ ë²„ì „ ê´€ë¦¬ íë¦„

```
learning_to_rank                    ltr-serving
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

experiments/
â”œâ”€â”€ exp001_ranknet/
â”‚   â””â”€â”€ model.pt â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”œâ”€â”€ exp002_listnet/        â”‚
â”‚   â””â”€â”€ model.pt           â”‚
â””â”€â”€ exp003_lambdarank/     â”‚ ì‹¤í—˜ ë¹„êµ
    â””â”€â”€ model.pt â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ NDCG@10 í‰ê°€
                           â”‚
                           â–¼
checkpoints/validated/
â””â”€â”€ lambdarank_v1.0.0.pt â”€â”€â”
                           â”‚ ONNX ë³€í™˜
                           â”‚
                           â–¼
production/
â”œâ”€â”€ model_v1.0.0.onnx â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â–¶ models/versions/v1.0.0/
â”œâ”€â”€ metadata.json          â”‚        â”œâ”€â”€ model.onnx
â””â”€â”€ preprocessor.pkl â”€â”€â”€â”€â”€â”€â”˜        â”œâ”€â”€ metadata.json
                                    â””â”€â”€ preprocessor.pkl
                                             â”‚
                                             â–¼
                                    models/current/ (ì‹¬ë³¼ë¦­ ë§í¬)
                                    â””â”€â”€ model.onnx â†’ versions/v1.0.0/
                                             â”‚
                                             â–¼
                                    FastAPI Server
                                    (ì‹¤ì‹œê°„ ì„œë¹™)
```

---

## ê°œë°œ í”„ë¡œì„¸ìŠ¤

### Phase 1: Research (learning_to_rank)

```bash
# Week 1-2: ì‹¤í—˜ ì„¤ê³„ ë° ê°œë°œ
cd learning_to_rank

# 1. ìƒˆ ì‹¤í—˜ ìƒì„±
mkdir experiments/exp004_ranknet_large
cp config.yaml experiments/exp004_ranknet_large/

# 2. ì„¤ì • ìˆ˜ì •
vim experiments/exp004_ranknet_large/config.yaml
# hidden_dims: [1024, 512, 256]

# 3. í•™ìŠµ ì‹¤í–‰
python scripts/train_pairwise.py \
    --config experiments/exp004_ranknet_large/config.yaml \
    --model ranknet \
    --device cuda

# 4. ê²°ê³¼ í™•ì¸
tensorboard --logdir logs/

# 5. ì—¬ëŸ¬ ì‹¤í—˜ ë¹„êµ
python scripts/compare_experiments.py \
    --experiments exp001,exp002,exp003,exp004
```

### Phase 2: Validation (learning_to_rank)

```bash
# Week 3: ëª¨ë¸ ê²€ì¦

# 1. í…ŒìŠ¤íŠ¸ì…‹ í‰ê°€
python scripts/evaluate.py \
    --model checkpoints/exp004_best.pt \
    --data data/raw/test.txt

# Output:
# NDCG@10: 0.528 â­ (ì´ì „ ìµœê³ : 0.525)
# MAP: 0.458
# MRR: 0.523

# 2. ê²€ì¦ í†µê³¼ â†’ validated/ë¡œ ì´ë™
mv checkpoints/exp004_best.pt \
   checkpoints/validated/ranknet_v1.1.0.pt

# 3. ONNX ë³€í™˜
python scripts/export_model.py \
    --model checkpoints/validated/ranknet_v1.1.0.pt \
    --output production/model_v1.1.0.onnx

# 4. ONNX ëª¨ë¸ ë²¤ì¹˜ë§ˆí¬
python scripts/benchmark_onnx.py \
    --model production/model_v1.1.0.onnx

# Output:
# PyTorch Latency: 52ms
# ONNX Latency: 4.8ms (10.8ë°° ë¹ ë¦„) âœ…
# Accuracy Match: 99.99% âœ…
```

### Phase 3: Deployment (ltr-serving)

```bash
# Week 4: í”„ë¡œë•ì…˜ ë°°í¬

cd ltr-serving

# 1. ìƒˆ ëª¨ë¸ ë²„ì „ ì¶”ê°€
mkdir models/versions/v1.1.0
cp ../learning_to_rank/production/model_v1.1.0.onnx \
   models/versions/v1.1.0/

# 2. ë¡œì»¬ í…ŒìŠ¤íŠ¸
docker-compose up -d
pytest tests/test_api.py
pytest tests/test_inference.py

# 3. Canary Deployment (10% íŠ¸ë˜í”½)
kubectl apply -f deployment/kubernetes/canary-v1.1.0.yaml

# 4. ëª¨ë‹ˆí„°ë§ (30ë¶„)
# Grafanaì—ì„œ í™•ì¸:
# - Latency: 45ms â†’ 43ms âœ…
# - Error Rate: 0.05% â†’ 0.04% âœ…
# - NDCG (online): 0.525 â†’ 0.528 âœ…

# 5. ì „ì²´ ì „í™˜
kubectl apply -f deployment/kubernetes/deployment-v1.1.0.yaml
kubectl scale deployment ltr-serving-v1.0.0 --replicas=0

# 6. ì´ì „ ë²„ì „ ì •ë¦¬ (1ì£¼ í›„)
kubectl delete deployment ltr-serving-v1.0.0
```

### Phase 4: Monitoring & Feedback

```bash
# Ongoing: ì˜¨ë¼ì¸ ëª¨ë‹ˆí„°ë§

# 1. Grafana ëŒ€ì‹œë³´ë“œ í™•ì¸
https://grafana.yourcompany.com/ltr-serving

# 2. ì£¼ê°„ ë¦¬í¬íŠ¸ ìƒì„±
python scripts/generate_weekly_report.py \
    --start-date 2026-01-01 \
    --end-date 2026-01-07

# Output:
# Weekly Report (2026-01-01 ~ 2026-01-07)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Total Requests: 10,245,432
# Avg Latency (P50): 44ms
# Avg Latency (P99): 94ms
# Error Rate: 0.045%
# Online NDCG@10: 0.529 â­ (ì˜¤í”„ë¼ì¸: 0.528)
#
# Recommendation: ì„±ëŠ¥ ê°œì„  í™•ì¸. ë‹¤ìŒ iteration ì§„í–‰ ê°€ëŠ¥.

# 3. í”¼ë“œë°±ì„ learning_to_rankë¡œ ì „ë‹¬
cd ../learning_to_rank
# ìƒˆë¡œìš´ ì‹¤í—˜ ì‹œì‘ (exp005)
```

---

## ë°°í¬ ì „ëµ

### 1. Blue-Green Deployment

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Blue-Green Deployment              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: Blue (í˜„ì¬) + Green (ìƒˆ ë²„ì „) ë™ì‹œ ì‹¤í–‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Blue v1.0.0  â”‚     â”‚ Green v1.1.0 â”‚
â”‚ (100% íŠ¸ë˜í”½)â”‚     â”‚ (0% íŠ¸ë˜í”½)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 2: í…ŒìŠ¤íŠ¸ íŠ¸ë˜í”½ ì „í™˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Blue v1.0.0  â”‚     â”‚ Green v1.1.0 â”‚
â”‚ (90% íŠ¸ë˜í”½) â”‚â”€â”€â”€â”€â–¶â”‚ (10% íŠ¸ë˜í”½) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                    [ëª¨ë‹ˆí„°ë§ 30ë¶„]

Step 3: ì „ì²´ ì „í™˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Blue v1.0.0  â”‚     â”‚ Green v1.1.0 â”‚
â”‚ (0% íŠ¸ë˜í”½)  â”‚â—€â”€â”€â”€â”€â”‚ (100% íŠ¸ë˜í”½)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 4: ë¡¤ë°± ê°€ëŠ¥ (ë¬¸ì œ ë°œìƒ ì‹œ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Blue v1.0.0  â”‚     â”‚ Green v1.1.0 â”‚
â”‚ (100% íŠ¸ë˜í”½)â”‚â—€â”€â”€â”€â”€â”‚ (0% íŠ¸ë˜í”½)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. A/B Testing

```python
# ltr-serving/app/services/ab_test.py

class ABTestService:
    def __init__(self):
        self.model_v1 = load_model('v1.0.0')
        self.model_v2 = load_model('v1.1.0')

    async def predict(self, features, user_id):
        # ì‚¬ìš©ì ID ê¸°ë°˜ ì¼ê´€ëœ ë¶„ë°°
        variant = hash(user_id) % 100

        if variant < 50:  # 50% A
            return await self.model_v1.predict(features)
        else:  # 50% B
            return await self.model_v2.predict(features)
```

---

## ëª¨ë‹ˆí„°ë§ ë° í”¼ë“œë°±

### ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Grafana Dashboard                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  [Request Rate]          [Latency Distribution]     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚ 1,200 QPS   â”‚         â”‚ P50: 45ms   â”‚          â”‚
â”‚   â”‚ â–² +5%       â”‚         â”‚ P99: 95ms   â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                      â”‚
â”‚  [Error Rate]            [Model Performance]        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚ 0.05%       â”‚         â”‚ NDCG: 0.528 â”‚          â”‚
â”‚   â”‚ â–¼ -0.02%    â”‚         â”‚ â–² +0.003    â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                      â”‚
â”‚  [Resource Usage]         [Pod Status]              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚ CPU: 65%    â”‚         â”‚ 3/3 Healthy â”‚          â”‚
â”‚   â”‚ Mem: 2.1GB  â”‚         â”‚             â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í”¼ë“œë°± ë£¨í”„

```
1. Online Metrics ìˆ˜ì§‘
   â†“
   Prometheus â†’ Grafana

2. ì£¼ê°„ ë¦¬í¬íŠ¸ ìƒì„±
   â†“
   ì„±ëŠ¥ ë¶„ì„ (NDCG, Latency, Error Rate)

3. ê°œì„  ì‚¬í•­ ë„ì¶œ
   â†“
   "Latencyê°€ ë†’ì•„ì§ â†’ ëª¨ë¸ ê²½ëŸ‰í™” í•„ìš”"
   "NDCG ì •ì²´ â†’ ìƒˆë¡œìš´ features ì¶”ê°€"

4. ìƒˆ ì‹¤í—˜ ì„¤ê³„
   â†“
   learning_to_rank/experiments/exp006

5. ë°˜ë³µ
```

---

## í™•ì¥ ë¡œë“œë§µ

### Timeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    í™•ì¥ ë¡œë“œë§µ (6ê°œì›”)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Month 1: Foundation âœ…
â”œâ”€â”€ learning_to_rank ì™„ì„±
â””â”€â”€ ê¸°ë³¸ ëª¨ë¸ ê°œë°œ ì™„ë£Œ

Month 2: Experiment Tracking ğŸ”„
â”œâ”€â”€ MLflow í†µí•©
â”œâ”€â”€ ì‹¤í—˜ ë¹„êµ ëŒ€ì‹œë³´ë“œ
â””â”€â”€ í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ (Optuna)

Month 3: Production Bridge ğŸ”„
â”œâ”€â”€ ONNX ë³€í™˜ íŒŒì´í”„ë¼ì¸
â”œâ”€â”€ CI/CD êµ¬ì¶•
â””â”€â”€ ìë™í™” í…ŒìŠ¤íŠ¸

Month 4: Production Serving ğŸ“‹
â”œâ”€â”€ ltr-serving ë ˆí¬ ìƒì„±
â”œâ”€â”€ FastAPI + ONNX Runtime
â”œâ”€â”€ Docker + K8s ë°°í¬
â””â”€â”€ Prometheus + Grafana

Month 5: Advanced Features ğŸ“‹
â”œâ”€â”€ A/B Testing í”„ë ˆì„ì›Œí¬
â”œâ”€â”€ Feature Store ê²€í† 
â””â”€â”€ Auto-scaling ìµœì í™”

Month 6: MLOps Platform ğŸ“‹
â”œâ”€â”€ ml-platform ë ˆí¬ ìƒì„±
â”œâ”€â”€ Model Registry (MLflow)
â”œâ”€â”€ Data Pipeline (Airflow)
â””â”€â”€ í†µí•© ëª¨ë‹ˆí„°ë§
```

### ìš°ì„ ìˆœìœ„

**P0 (ì¦‰ì‹œ)**:
- âœ… learning_to_rank ì™„ì„±
- ğŸ”„ ì‹¤í—˜ ì¶”ì  ê°œì„ 

**P1 (1-2ê°œì›”)**:
- ğŸ”„ ONNX ë³€í™˜
- ğŸ“‹ ltr-serving ë ˆí¬

**P2 (3-4ê°œì›”)**:
- ğŸ“‹ A/B Testing
- ğŸ“‹ ìë™í™” íŒŒì´í”„ë¼ì¸

**P3 (5-6ê°œì›”)**:
- ğŸ“‹ Feature Store
- ğŸ“‹ MLOps í”Œë«í¼

---

## íŒ€ ì—­í•  ë¶„ë‹´

### ì†Œê·œëª¨ íŒ€ (1-2ëª…)

```
ML Engineer (You)
â”œâ”€â”€ learning_to_rank ê°œë°œ ë° ìœ ì§€ë³´ìˆ˜
â”œâ”€â”€ ltr-serving ê°œë°œ ë° ë°°í¬
â””â”€â”€ ì „ì²´ ì‹œìŠ¤í…œ ê´€ë¦¬
```

### ì¤‘ê·œëª¨ íŒ€ (3-5ëª…)

```
ML Research Engineer (2ëª…)
â”œâ”€â”€ ëª¨ë¸ ê°œë°œ (learning_to_rank)
â””â”€â”€ ì‹¤í—˜ ë° í‰ê°€

ML Platform Engineer (2ëª…)
â”œâ”€â”€ ì„œë¹™ ì¸í”„ë¼ (ltr-serving)
â””â”€â”€ ëª¨ë‹ˆí„°ë§ ë° ìš´ì˜

Data Engineer (1ëª…)
â”œâ”€â”€ ë°ì´í„° íŒŒì´í”„ë¼ì¸
â””â”€â”€ Feature Engineering
```

### ëŒ€ê·œëª¨ íŒ€ (6+ëª…)

```
ML Research Team
â”œâ”€â”€ Senior ML Scientist (1ëª…) - ì—°êµ¬ ë°©í–¥ ì„¤ì •
â”œâ”€â”€ ML Engineers (2-3ëª…) - ëª¨ë¸ ê°œë°œ
â””â”€â”€ Research Intern (1-2ëª…) - ì‹¤í—˜ ì§€ì›

ML Platform Team
â”œâ”€â”€ Platform Lead (1ëª…) - ì¸í”„ë¼ ì„¤ê³„
â”œâ”€â”€ DevOps Engineers (2ëª…) - K8s, CI/CD
â””â”€â”€ SRE (1ëª…) - ëª¨ë‹ˆí„°ë§, ìš´ì˜

Data Team
â”œâ”€â”€ Data Engineers (2ëª…) - íŒŒì´í”„ë¼ì¸
â””â”€â”€ Analytics Engineer (1ëª…) - ë©”íŠ¸ë¦­ ë¶„ì„
```

---

## ë¹„ìš© ì¶”ì •

### ê°œë°œ í™˜ê²½ (learning_to_rank)

```
ë¡œì»¬ GPU (RTX 3090)
- ì´ˆê¸° ë¹„ìš©: $1,500
- ì „ê¸°ë£Œ: $20/ì›”
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ì´ ë¹„ìš©: ~$1,500 (1íšŒ)

ë˜ëŠ” í´ë¼ìš°ë“œ GPU
- AWS p3.2xlarge: $3.06/ì‹œê°„
- ì£¼ 20ì‹œê°„ í•™ìŠµ: $245/ì›”
```

### í”„ë¡œë•ì…˜ í™˜ê²½ (ltr-serving)

```
Kubernetes Cluster
- 3 Nodes (4 vCPU, 16GB RAM each)
- AWS EKS: ~$0.10/ì‹œê°„ Ã— 3 = $0.30/ì‹œê°„
- ì›”: $216

Redis Cache
- ElastiCache r6g.large: $0.201/ì‹œê°„
- ì›”: $145

Monitoring
- Prometheus + Grafana Cloud: $50/ì›”
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ì´ ë¹„ìš©: ~$411/ì›”
```

---

## ì²´í¬ë¦¬ìŠ¤íŠ¸

### learning_to_rank ì™„ì„±ë„

- [x] Pairwise ëª¨ë¸ (RankNet, LambdaRank)
- [x] Listwise ëª¨ë¸ (ListNet, ListMLE, ApproxNDCG)
- [x] ë°ì´í„° ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸
- [x] í•™ìŠµ íŒŒì´í”„ë¼ì¸
- [x] ì˜¤í”„ë¼ì¸ í‰ê°€
- [ ] ì‹¤í—˜ ì¶”ì  (MLflow)
- [ ] ONNX ë³€í™˜
- [ ] CI/CD íŒŒì´í”„ë¼ì¸

### ltr-serving ì¤€ë¹„ë„

- [ ] FastAPI ì„œë²„
- [ ] ONNX Runtime í†µí•©
- [ ] Redis ìºì‹±
- [ ] Docker ì´ë¯¸ì§€
- [ ] Kubernetes ë°°í¬
- [ ] Prometheus ë©”íŠ¸ë¦­
- [ ] Grafana ëŒ€ì‹œë³´ë“œ
- [ ] ë¶€í•˜ í…ŒìŠ¤íŠ¸

---

## ì°¸ê³  ìë£Œ

### ë‚´ë¶€ ë¬¸ì„œ
- [learning_to_rank/ARCHITECTURE.md](../ARCHITECTURE.md)
- [ltr-serving README](ltr-serving-README-template.md)

### ì™¸ë¶€ ì°¸ê³ 
- [MLOps Best Practices](https://ml-ops.org/)
- [ONNX Runtime Performance Tuning](https://onnxruntime.ai/docs/performance/)
- [Kubernetes Production Best Practices](https://kubernetes.io/docs/setup/best-practices/)
- [FastAPI Deployment](https://fastapi.tiangolo.com/deployment/)

---

**ìµœì¢… ì—…ë°ì´íŠ¸**: 2026-01-04
**ë²„ì „**: 1.0.0
**ìƒíƒœ**: Active Development
